<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Match Predictor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .form-section {
            margin-bottom: 25px;
        }

        .form-section h3 {
            color: #2a5298;
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 8px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #555;
            font-size: 0.9rem;
        }

        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #2a5298;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }

        .predict-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .predict-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.3);
        }

        .predict-btn:active {
            transform: translateY(0);
        }

        .results {
            display: none;
        }

        .outcome-card {
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .outcome-home { background: linear-gradient(135deg, #007bff, #0056b3); }
        .outcome-draw { background: linear-gradient(135deg, #ffc107, #e0a800); }
        .outcome-away { background: linear-gradient(135deg, #dc3545, #c82333); }

        .prob-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .prob-card {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
        }

        .prob-card h4 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .prob-card .percentage {
            font-size: 2rem;
            font-weight: bold;
            color: #2a5298;
        }

        .expected-goals {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .goals-card {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            border-radius: 10px;
        }

        .quality-scores {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .quality-card {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #6f42c1, #5a32a3);
            color: white;
            border-radius: 10px;
        }

        .model-breakdown {
            margin-top: 20px;
        }

        .model-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #2a5298;
        }

        .model-item h5 {
            color: #2a5298;
            margin-bottom: 8px;
            text-transform: capitalize;
        }

        .model-probs {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
        }

        .advice-section {
            background: linear-gradient(135deg, #fd7e14, #e8590c);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 20px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }

        .comparison-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .prob-grid {
                grid-template-columns: 1fr;
            }

            .expected-goals,
            .quality-scores {
                grid-template-columns: 1fr;
            }

            .model-probs {
                flex-direction: column;
                gap: 5px;
            }

            .comparison-table {
                font-size: 0.8rem;
            }
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2a5298;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öΩ Football Match Predictor</h1>
            <p>Advanced AI-powered match outcome prediction</p>
        </div>

        <div class="card">
            <form id="matchForm">
                <div class="form-section">
                    <h3>üè† Home Team Statistics</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="homeAvgScore">Average Goals Scored</label>
                            <input type="number" id="homeAvgScore" step="0.01" value="1.43" required>
                        </div>
                        <div class="form-group">
                            <label for="homeAvgConceded">Average Goals Conceded</label>
                            <input type="number" id="homeAvgConceded" step="0.01" value="0.91" required>
                        </div>
                        <div class="form-group">
                            <label for="homeScorePercentage">Scoring Percentage (%)</label>
                            <input type="number" id="homeScorePercentage" min="0" max="100" value="65" required>
                        </div>
                        <div class="form-group">
                            <label for="homeCleansheet">Clean Sheet Percentage (%)</label>
                            <input type="number" id="homeCleansheet" min="0" max="100" value="35" required>
                        </div>
                        <div class="form-group">
                            <label for="homeDifficulty">Fixture Difficulty (1-5)</label>
                            <select id="homeDifficulty" required>
                                <option value="1">1 - Very Easy</option>
                                <option value="2">2 - Easy</option>
                                <option value="3">3 - Medium</option>
                                <option value="4" selected>4 - Hard</option>
                                <option value="5">5 - Very Hard</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="homeOdds">Betting Odds</label>
                            <input type="number" id="homeOdds" step="0.01" value="2.2" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>‚úàÔ∏è Away Team Statistics</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="awayAvgScore">Average Goals Scored</label>
                            <input type="number" id="awayAvgScore" step="0.01" value="1.22" required>
                        </div>
                        <div class="form-group">
                            <label for="awayAvgConceded">Average Goals Conceded</label>
                            <input type="number" id="awayAvgConceded" step="0.01" value="1.39" required>
                        </div>
                        <div class="form-group">
                            <label for="awayScorePercentage">Scoring Percentage (%)</label>
                            <input type="number" id="awayScorePercentage" min="0" max="100" value="65" required>
                        </div>
                        <div class="form-group">
                            <label for="awayCleansheet">Clean Sheet Percentage (%)</label>
                            <input type="number" id="awayCleansheet" min="0" max="100" value="4" required>
                        </div>
                        <div class="form-group">
                            <label for="awayDifficulty">Fixture Difficulty (1-5)</label>
                            <select id="awayDifficulty" required>
                                <option value="1" selected>1 - Very Easy</option>
                                <option value="2">2 - Easy</option>
                                <option value="3">3 - Medium</option>
                                <option value="4">4 - Hard</option>
                                <option value="5">5 - Very Hard</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="awayOdds">Betting Odds</label>
                            <input type="number" id="awayOdds" step="0.01" value="3.1" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>üéØ Match Odds</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="drawOdds">Draw Odds</label>
                            <input type="number" id="drawOdds" step="0.01" value="3.4" required>
                        </div>
                    </div>
                </div>

                <button type="submit" class="predict-btn">üîÆ Predict Match Outcome</button>
            </form>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Analyzing match data...</p>
            </div>
        </div>

        <div id="results" class="results">
            <div class="card">
                <div id="outcomeCard" class="outcome-card">
                    <div id="outcomeText"></div>
                    <div id="confidenceText"></div>
                </div>

                <h3 style="color: #2a5298; margin-bottom: 15px;">üìä Final Probabilities</h3>
                <div class="prob-grid">
                    <div class="prob-card">
                        <h4>Home Win</h4>
                        <div class="percentage" id="homeWinProb">0%</div>
                    </div>
                    <div class="prob-card">
                        <h4>Draw</h4>
                        <div class="percentage" id="drawProb">0%</div>
                    </div>
                    <div class="prob-card">
                        <h4>Away Win</h4>
                        <div class="percentage" id="awayWinProb">0%</div>
                    </div>
                </div>

                <h3 style="color: #2a5298; margin-bottom: 15px;">‚öΩ Expected Goals</h3>
                <div class="expected-goals">
                    <div class="goals-card">
                        <h4>Home Team</h4>
                        <div style="font-size: 2rem; font-weight: bold;" id="homeExpectedGoals">0.00</div>
                    </div>
                    <div class="goals-card">
                        <h4>Away Team</h4>
                        <div style="font-size: 2rem; font-weight: bold;" id="awayExpectedGoals">0.00</div>
                    </div>
                </div>

                <h3 style="color: #2a5298; margin-bottom: 15px;">üèÜ Team Quality Scores</h3>
                <div class="quality-scores">
                    <div class="quality-card">
                        <h4>Home Team</h4>
                        <div style="font-size: 2rem; font-weight: bold;" id="homeQuality">0.000</div>
                    </div>
                    <div class="quality-card">
                        <h4>Away Team</h4>
                        <div style="font-size: 2rem; font-weight: bold;" id="awayQuality">0.000</div>
                    </div>
                </div>

                <h3 style="color: #2a5298; margin-bottom: 15px;">üîç Model Breakdown</h3>
                <div id="modelBreakdown" class="model-breakdown"></div>

                <h3 style="color: #2a5298; margin-bottom: 15px;">üß† Advanced Analysis</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Outcome</th>
                            <th>Final Prob</th>
                            <th>Composite Prob</th>
                            <th>Difference</th>
                        </tr>
                    </thead>
                    <tbody id="comparisonTable">
                    </tbody>
                </table>

                <div id="adviceSection" class="advice-section"></div>
            </div>
        </div>
    </div>

    <script>
        // Enums and Classes
        const Outcome = {
            HOME_WIN: "Home Win",
            DRAW: "Draw",
            AWAY_WIN: "Away Win"
        };

        class MatchData {
            constructor(data) {
                this.homeAvgScore = data.homeAvgScore;
                this.awayAvgScore = data.awayAvgScore;
                this.homeAvgConceded = data.homeAvgConceded;
                this.awayAvgConceded = data.awayAvgConceded;
                this.homeScorePercentage = data.homeScorePercentage;
                this.awayScorePercentage = data.awayScorePercentage;
                this.homeCleansheet = data.homeCleansheet;
                this.awayCleansheet = data.awayCleansheet;
                this.homeDifficulty = data.homeDifficulty;
                this.awayDifficulty = data.awayDifficulty;
                this.homeOdds = data.homeOdds;
                this.drawOdds = data.drawOdds;
                this.awayOdds = data.awayOdds;
            }
        }

        class FootballPredictor {
            constructor() {
                this.weights = {
                    poisson: 0.25,
                    formBased: 0.20,
                    defensiveStrength: 0.15,
                    marketSentiment: 0.20,
                    compositeRating: 0.20
                };
            }

            factorial(n) {
                if (n <= 1) return 1;
                let result = 1;
                for (let i = 2; i <= n; i++) {
                    result *= i;
                }
                return result;
            }

            poissonProb(k, lam) {
                if (lam <= 0) {
                    return k === 0 ? 1.0 : 0.0;
                }
                return (Math.pow(lam, k) * Math.exp(-lam)) / this.factorial(k);
            }

            calculatePoissonProbabilities(matchData) {
                // Adjust scores based on opposition difficulty
                const homeAttackStrength = matchData.homeAvgScore * (6 - matchData.awayDifficulty) / 5;
                const awayAttackStrength = matchData.awayAvgScore * (6 - matchData.homeDifficulty) / 5;

                const homeDefenseStrength = matchData.homeAvgConceded * (matchData.awayDifficulty / 5);
                const awayDefenseStrength = matchData.awayAvgConceded * (matchData.homeDifficulty / 5);

                // Expected goals calculation
                const homeExpectedGoals = (homeAttackStrength + awayDefenseStrength) / 2;
                const awayExpectedGoals = (awayAttackStrength + homeDefenseStrength) / 2;

                // Poisson probabilities for different score outcomes
                const maxGoals = 6;
                const probMatrix = [];
                for (let i = 0; i <= maxGoals; i++) {
                    probMatrix[i] = [];
                    for (let j = 0; j <= maxGoals; j++) {
                        const probH = this.poissonProb(i, homeExpectedGoals);
                        const probA = this.poissonProb(j, awayExpectedGoals);
                        probMatrix[i][j] = probH * probA;
                    }
                }

                // Calculate outcome probabilities
                let homeWin = 0, draw = 0, awayWin = 0;

                for (let h = 0; h <= maxGoals; h++) {
                    for (let a = 0; a <= maxGoals; a++) {
                        if (h > a) homeWin += probMatrix[h][a];
                        else if (h === a) draw += probMatrix[h][a];
                        else awayWin += probMatrix[h][a];
                    }
                }

                return {
                    homeWin,
                    draw,
                    awayWin,
                    expectedGoals: { home: homeExpectedGoals, away: awayExpectedGoals }
                };
            }

            calculateFormBasedPrediction(matchData) {
                // Normalize scoring percentages
                const homeForm = matchData.homeScorePercentage / 100.0;
                const awayForm = matchData.awayScorePercentage / 100.0;

                // Calculate relative form advantage
                const totalForm = homeForm + awayForm;
                let homeFormAdvantage, awayFormAdvantage;

                if (totalForm > 0) {
                    homeFormAdvantage = homeForm / totalForm;
                    awayFormAdvantage = awayForm / totalForm;
                } else {
                    homeFormAdvantage = awayFormAdvantage = 0.5;
                }

                // Adjust for home advantage
                const homeAdvantageBoost = 0.07;
                homeFormAdvantage += homeAdvantageBoost;

                // Normalize to ensure probabilities sum to 1
                const formSum = homeFormAdvantage + awayFormAdvantage;
                homeFormAdvantage /= formSum;
                awayFormAdvantage /= formSum;

                // Calculate draw probability
                const formDifference = Math.abs(homeFormAdvantage - awayFormAdvantage);
                let drawProb = 0.35 - (formDifference * 0.2);
                drawProb = Math.max(0.15, Math.min(0.45, drawProb));

                // Redistribute remaining probability
                const remainingProb = 1.0 - drawProb;
                const homeWinProb = homeFormAdvantage * remainingProb;
                const awayWinProb = awayFormAdvantage * remainingProb;

                return {
                    homeWin: homeWinProb,
                    draw: drawProb,
                    awayWin: awayWinProb
                };
            }

            calculateDefensiveStrengthModel(matchData) {
                // Calculate defensive ratings
                const homeDefenseRating = (matchData.homeCleansheet / 100.0) * (1 / Math.max(0.1, matchData.homeAvgConceded));
                const awayDefenseRating = (matchData.awayCleansheet / 100.0) * (1 / Math.max(0.1, matchData.awayAvgConceded));

                // Calculate attacking threat against defense
                const homeAttackVsAwayDefense = matchData.homeAvgScore / Math.max(0.1, matchData.awayAvgConceded);
                const awayAttackVsHomeDefense = matchData.awayAvgScore / Math.max(0.1, matchData.homeAvgConceded);

                // Normalize attack ratios
                const totalAttackRatio = homeAttackVsAwayDefense + awayAttackVsHomeDefense;
                let homeAttackNorm, awayAttackNorm;

                if (totalAttackRatio > 0) {
                    homeAttackNorm = homeAttackVsAwayDefense / totalAttackRatio;
                    awayAttackNorm = awayAttackVsHomeDefense / totalAttackRatio;
                } else {
                    homeAttackNorm = awayAttackNorm = 0.5;
                }

                // Strong defenses increase draw probability
                const avgDefenseStrength = (homeDefenseRating + awayDefenseRating) / 2;
                const drawBoost = Math.min(0.15, avgDefenseStrength * 0.3);

                const baseDraw = 0.25 + drawBoost;
                const remainingProb = 1.0 - baseDraw;

                return {
                    homeWin: homeAttackNorm * remainingProb,
                    draw: baseDraw,
                    awayWin: awayAttackNorm * remainingProb
                };
            }

            calculateMarketSentimentModel(matchData) {
                // Convert odds to implied probabilities
                const homeImplied = 1 / matchData.homeOdds;
                const drawImplied = 1 / matchData.drawOdds;
                const awayImplied = 1 / matchData.awayOdds;

                // Remove overround (bookmaker margin)
                const totalImplied = homeImplied + drawImplied + awayImplied;

                // Normalize to true probabilities
                return {
                    homeWin: homeImplied / totalImplied,
                    draw: drawImplied / totalImplied,
                    awayWin: awayImplied / totalImplied
                };
            }

            calculateCompositeRatingModel(matchData) {
                // Calculate team quality scores
                const homeQuality = (
                    matchData.homeAvgScore * 0.3 +
                    (1 / Math.max(0.1, matchData.homeAvgConceded)) * 0.2 +
                    (matchData.homeScorePercentage / 100) * 0.25 +
                    (matchData.homeCleansheet / 100) * 0.15 +
                    ((6 - matchData.homeDifficulty) / 5) * 0.1
                );

                const awayQuality = (
                    matchData.awayAvgScore * 0.3 +
                    (1 / Math.max(0.1, matchData.awayAvgConceded)) * 0.2 +
                    (matchData.awayScorePercentage / 100) * 0.25 +
                    (matchData.awayCleansheet / 100) * 0.15 +
                    ((6 - matchData.awayDifficulty) / 5) * 0.1
                );

                // Quality difference analysis
                const qualityDiff = homeQuality - awayQuality;
                const qualitySum = homeQuality + awayQuality;

                // Sigmoid transformation for probability
                let homeBaseProb, awayBaseProb;
                if (qualitySum > 0) {
                    homeBaseProb = 1 / (1 + Math.exp(-qualityDiff * 3));
                    awayBaseProb = 1 - homeBaseProb;
                } else {
                    homeBaseProb = awayBaseProb = 0.5;
                }

                // Adjust for match context
                const contextFactor = Math.sqrt(homeQuality * awayQuality);
                let drawProb = 0.2 + (contextFactor * 0.15);
                drawProb = Math.min(0.4, drawProb);

                // Redistribute
                const remaining = 1.0 - drawProb;
                const homeWinProb = homeBaseProb * remaining;
                const awayWinProb = awayBaseProb * remaining;

                return {
                    homeWin: homeWinProb,
                    draw: drawProb,
                    awayWin: awayWinProb,
                    homeQuality,
                    awayQuality
                };
            }

            predictMatch(matchData) {
                // Calculate predictions from all models
                const poissonPred = this.calculatePoissonProbabilities(matchData);
                const formPred = this.calculateFormBasedPrediction(matchData);
                const defensePred = this.calculateDefensiveStrengthModel(matchData);
                const marketPred = this.calculateMarketSentimentModel(matchData);
                const compositePred = this.calculateCompositeRatingModel(matchData);

                // Ensemble prediction using weighted average
                let finalHome = (
                    poissonPred.homeWin * this.weights.poisson +
                    formPred.homeWin * this.weights.formBased +
                    defensePred.homeWin * this.weights.defensiveStrength +
                    marketPred.homeWin * this.weights.marketSentiment +
                    compositePred.homeWin * this.weights.compositeRating
                );

                let finalDraw = (
                    poissonPred.draw * this.weights.poisson +
                    formPred.draw * this.weights.formBased +
                    defensePred.draw * this.weights.defensiveStrength +
                    marketPred.draw * this.weights.marketSentiment +
                    compositePred.draw * this.weights.compositeRating
                );

                let finalAway = (
                    poissonPred.awayWin * this.weights.poisson +
                    formPred.awayWin * this.weights.formBased +
                    defensePred.awayWin * this.weights.defensiveStrength +
                    marketPred.awayWin * this.weights.marketSentiment +
                    compositePred.awayWin * this.weights.compositeRating
                );

                // Normalize to ensure probabilities sum to 1
                const total = finalHome + finalDraw + finalAway;
                finalHome /= total;
                finalDraw /= total;
                finalAway /= total;

                // Determine most likely outcome
                const maxProb = Math.max(finalHome, finalDraw, finalAway);
                let predictedOutcome;
                if (maxProb === finalHome) {
                    predictedOutcome = Outcome.HOME_WIN;
                } else if (maxProb === finalDraw) {
                    predictedOutcome = Outcome.DRAW;
                } else {
                    predictedOutcome = Outcome.AWAY_WIN;
                }

                // Calculate confidence (entropy-based)
                const probs = [final